# Maintainer: Daniel YC Lin <dlin.tw at gmail>
pkgname=glibc
pkgver=2.6.1
pkgrel=74.2
pkgdesc="STLinux GNU C Library"
arch=(sh4)
license=('GPL' 'LGPL')
groups=('base')
depends=('linux-api-headers' 'tzdata' 'filesystem')
makedepends=('gcc')
backup=(etc/locale.gen
        etc/nscd.conf)
options=('!strip')
install=glibc.stlinux.install
url="http://gcc.gnu.org"
source=(http://ftp.stlinux.com/pub/stlinux/2.3/updates/RPMS/sh4/stlinux23-sh4-glibc-2.6.1-74.sh4.rpm
http://ftp.stlinux.com/pub/stlinux/2.3/updates/RPMS/sh4/stlinux23-sh4-glibc-debuginfo-2.6.1-74.sh4.rpm
http://ftp.stlinux.com/pub/stlinux/2.3/updates/RPMS/sh4/stlinux23-sh4-glibc-dev-2.6.1-74.sh4.rpm
http://ftp.stlinux.com/pub/stlinux/2.3/updates/RPMS/sh4/stlinux23-sh4-glibc-i18ndata-2.6.1-74.sh4.rpm
http://ftp.stlinux.com/pub/stlinux/2.3/updates/RPMS/sh4/stlinux23-sh4-glibc-locales-2.6.1-74.sh4.rpm
http://ftp.stlinux.com/pub/stlinux/2.3/updates/RPMS/sh4/stlinux23-sh4-glibc-nscd-2.6.1-74.sh4.rpm
http://ftp.stlinux.com/pub/stlinux/2.3/updates/RPMS/sh4/stlinux23-sh4-glibc-prof-2.6.1-74.sh4.rpm
        nscd.service
        nscd.tmpfiles
        locale.gen.txt
        locale-gen)

package() {
  cp -r opt/STM/STLinux-2.3/devkit/sh4/target/* $pkgdir
  rm -fr $pkgdir/usr/share/zoneinfo # in pkg tzdata
  rm -f $pkgdir/etc/{host.conf,ld.so.conf,nsswitch.conf}  # in pkg filesystem

  install -m755 ${srcdir}/locale-gen ${pkgdir}/usr/bin

  # temporary symlink
  ln -s ../../sbin/ldconfig ${pkgdir}/usr/bin/ldconfig

  # create /etc/locale.gen
  install -m644 ${srcdir}/locale.gen.txt ${pkgdir}/etc/locale.gen

}

md5sums=('7dc08eaa288b3f17ba8136afb70f6307'
         '4d18e25892260fa612e2427dd2688af9'
         'fa86436122d5b2e44328204483371a2c'
         '211025301b1b04b1323d2dc38c63521b'
         '9df0b955ad13e3a3afa946a3abe3092f'
         'eb799c70b135b027abef2f30337f4b86'
         '3ad7ffc1a413795f1271dea56657acfc'
         'c1e07c0bec0fe89791bfd9d13fc85edf'
         'bccbe5619e75cf1d97312ec3681c605c'
         '07ac979b6ab5eeb778d55f041529d623'
         '476e9113489f93b348b21e144b6a8fcf')
md5sums=('7dc08eaa288b3f17ba8136afb70f6307'
         '4d18e25892260fa612e2427dd2688af9'
         'fa86436122d5b2e44328204483371a2c'
         '211025301b1b04b1323d2dc38c63521b'
         '9df0b955ad13e3a3afa946a3abe3092f'
         'eb799c70b135b027abef2f30337f4b86'
         '3ad7ffc1a413795f1271dea56657acfc'
         'c1e07c0bec0fe89791bfd9d13fc85edf'
         'bccbe5619e75cf1d97312ec3681c605c'
         'be88cda4ec35efadc0c9394947786d79'
         '476e9113489f93b348b21e144b6a8fcf')
